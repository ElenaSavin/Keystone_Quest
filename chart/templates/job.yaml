{{- range .Values.uuids }}
apiVersion: batch/v1
kind: Job
metadata:
  name: {{ $.Release.Name }}-job-{{ . }}
spec:
  template:
    spec:
      containers:
      - name: worker
        image: iad.ocir.io/ax5gr8jsnjx1/keystone:oci
        imagePullPolicy: Always
        command: 
          - /bin/bash
          - -c
        args: ["./run.sh", "{{ . }}"]
      restartPolicy: OnFailure
      
  backoffPolicy:
    type: BackoffPeriodic
    periodSeconds: 30
    maxAttempts: 3
---
{{- end }}
